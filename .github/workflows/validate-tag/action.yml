---

name: validate-tag
description: Validate tag format
    
inputs:
  tag:
    description: 'Tag to validate'
    required: true
    
runs:
  using: "composite"
  steps:
    - name: Validate tag does not exist on current commit
      id: validate-tag
      shell: 'bash'
      run: |
        if ! [ $(echo "$TAG" | grep -P "(\d{1,2})\.(\d{1,2})\.(\d{1,2})") ]; then
          echo "Tag should be a SemVer format"
          exit 1
        fi
        if [ $(git tag -l "$TAG") ]; then
          echo "The tag $TAG already exists"
          exit 1
        fi
      env:
        TAG: ${{ inputs.tag }}
